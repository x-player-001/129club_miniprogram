<!-- pages/user/stats/stats.wxml - å…¨æ–°è½»é‡è®¾è®¡ -->
<view class="page-container">
  <!-- èµ›å­£ç­›é€‰å™¨ -->
  <view class="season-filter" wx:if="{{seasonOptions.length > 0}}">
    <picker
      mode="selector"
      range="{{seasonOptions}}"
      range-key="name"
      value="{{seasonIndex}}"
      bindchange="onSeasonChange">
      <view class="season-picker-btn">
        <text class="season-text">{{seasonOptions[seasonIndex].name}}</text>
        <text class="season-arrow">â–¼</text>
      </view>
    </picker>
  </view>

  <!-- é¡¶éƒ¨ä¿¡æ¯åŒºåŸŸ -->
  <view class="header-section">
    <view class="profile-card">
      <!-- å‡ ä½•è£…é¥°å…ƒç´  -->
      <view class="geo-circle-1"></view>
      <view class="geo-circle-2"></view>
      <view class="geo-triangle"></view>
      <view class="geo-square"></view>
      <view class="geo-football"></view>

      <view class="profile-layout">
        <!-- å¤´åƒï¼ˆå·¦ä¾§ç‹¬ç«‹ï¼‰ -->
        <image class="avatar" src="{{userInfo.avatar || images.defaultAvatar}}" mode="aspectFill"></image>

        <!-- ä¸­é—´ï¼šæ–‡å­—ä¿¡æ¯ï¼ˆå§“åã€å·ç ã€æ˜µç§°ã€æƒ¯ç”¨è„šï¼‰-->
        <view class="text-column">
          <view class="name-row">
            <text class="name">{{userInfo.realName || userInfo.nickname || 'æœªè®¾ç½®'}}</text>
          </view>
          <text class="number-badge">#{{userInfo.jerseyNumber || '0'}}</text>
          <text class="nickname" wx:if="{{userInfo.nickname && userInfo.realName}}">@{{userInfo.nickname}}</text>

          <!-- æƒ¯ç”¨è„šï¼ˆç¼©å°åˆ°2/3ï¼‰ -->
          <view class="foot-row">
            <foot-skill-display
              leftFootSkill="{{userInfo.leftFootSkill}}"
              rightFootSkill="{{userInfo.rightFootSkill}}">
            </foot-skill-display>
          </view>
        </view>

        <!-- å³ä¾§ï¼šè¶³çƒåœºä½ç½®å¯è§†åŒ– -->
        <view class="field-container">
          <football-field
            jerseyNumber="{{userInfo.jerseyNumber}}"
            positionCodes="{{userPositionCodes}}"
            bind:markerTap="onPositionMarkerTap">
          </football-field>
        </view>
      </view>
    </view>
  </view>

  <!-- æ ¸å¿ƒæ•°æ®ç½‘æ ¼ -->
  <view class="stats-grid-section">
    <view class="stats-grid">
      <view class="stat-card" wx:for="{{coreStats}}" wx:key="label" bindtap="onStatTap" data-type="{{item.type}}">
        <image class="stat-icon" src="{{item.icon}}" mode="aspectFit"></image>
        <text class="stat-value">{{item.value}}</text>
        <text class="stat-label">{{item.label}}</text>
      </view>
    </view>
  </view>

  <!-- èº«ä»·å¡ç‰‡ -->
  <view class="value-section" wx:if="{{hasValueData}}" bindtap="onValueTap">
    <view class="value-card-new">
      <view class="value-header">
        <view class="value-title-row">
          <text class="value-icon">ğŸ’°</text>
          <text class="value-title">æˆ‘çš„èº«ä»·</text>
        </view>
        <view class="value-nav">
          <text class="value-nav-text">èº«ä»·æ˜ç»†</text>
          <text class="value-nav-arrow">â€º</text>
        </view>
      </view>
      <view class="value-content">
        <view class="value-main">
          <text class="value-number-big">{{valueInfo.totalValue}}</text>
          <text class="value-unit-big">ä¸‡</text>
        </view>
        <view class="value-rank-tag" wx:if="{{valueInfo.rank > 0}}">
          <text class="rank-medal">ğŸ…</text>
          <text class="rank-num">NO.{{valueInfo.rank}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- è¯¦ç»†æ•°æ®åˆ—è¡¨ï¼ˆä»…ä¿ç•™èƒœç‡å’Œå‡ºå‹¤ç‡ï¼‰ -->
  <view class="details-section">
    <view class="detail-row" wx:for="{{secondaryStats}}" wx:key="label" wx:if="{{item.showProgress}}">
      <view class="detail-left">
        <text class="detail-label">{{item.label}}</text>
        <view class="detail-progress">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{item.percent}}%; background: {{item.color}};"></view>
          </view>
        </view>
      </view>
      <view class="detail-right">
        <text class="detail-value">{{item.value}}</text>
        <text class="detail-unit" wx:if="{{item.unit}}">{{item.unit}}</text>
      </view>
    </view>
  </view>

  <!-- æ’åæ ‡ç­¾äº‘ -->
  <view class="rankings-section" wx:if="{{rankings.length > 0}}">
    <view class="section-title-simple">æ’åè£èª‰</view>
    <view class="ranking-tags">
      <view class="rank-tag {{item.medal}}" wx:for="{{rankings}}" wx:key="type">
        <text class="tag-icon">{{item.icon}}</text>
        <text class="tag-text">{{item.type}} NO.{{item.rank}}</text>
      </view>
    </view>
  </view>

  <!-- æˆå°±ç½‘æ ¼ -->
  <view class="achievements-section" wx:if="{{achievements.length > 0}}">
    <view class="section-header-simple">
      <text class="section-title-simple">æˆ‘çš„æˆå°±</text>
      <text class="count-badge">{{unlockedCount}}/{{achievements.length}}</text>
    </view>
    <view class="achievement-grid">
      <view class="achievement-mini {{item.unlocked ? 'unlocked' : 'locked'}}" wx:for="{{achievements}}" wx:key="id">
        <view class="achievement-icon-mini">
          <image wx:if="{{item.isImageIcon}}" class="icon-img" src="{{item.icon}}" mode="aspectFit"></image>
          <text wx:else class="icon-emoji">{{item.icon}}</text>
        </view>
        <text class="achievement-name-mini">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨å ä½ -->
  <view class="bottom-space"></view>
</view>
