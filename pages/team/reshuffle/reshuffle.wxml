<!-- é˜Ÿä¼é‡ç»„ï¼ˆDrafté€‰äººï¼‰é¡µé¢ -->
<view class="reshuffle-container">
  <!-- é¡¶éƒ¨è¿›åº¦æ¡ -->
  <view class="progress-header">
    <view class="progress-info">
      <text class="progress-text">ç¬¬ {{currentRound}}/{{totalRounds}} è½®</text>
      <text class="turn-indicator" wx:if="{{draftStatus === 'in_progress'}}">
        è½®åˆ°ï¼š<text class="captain-name {{currentTurn === 'captain1' ? 'captain1-color' : 'captain2-color'}}">
          {{currentTurn === 'captain1' ? captain1.name : captain2.name}}
        </text>
      </text>
    </view>
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{(currentRound / totalRounds) * 100}}%"></view>
    </view>
  </view>

  <scroll-view class="content" scroll-y enable-back-to-top>
    <!-- Draftè¿›è¡Œä¸­ -->
    <view class="draft-area" wx:if="{{draftStatus === 'in_progress'}}">
      <!-- ä¸‰æ å¸ƒå±€ -->
      <view class="teams-layout">
        <!-- é˜Ÿä¼1 -->
        <view class="team-column team1-column">
          <view class="team-header">
            <image class="captain-avatar" src="{{captain1.avatar}}" mode="aspectFill"></image>
            <text class="team-title">{{captain1.name}}çš„é˜Ÿä¼</text>
            <text class="team-count">{{team1Players.length}}äºº</text>
          </view>
          <view class="player-list">
            <view class="player-item-small" wx:for="{{team1Players}}" wx:key="id">
              <image class="player-avatar-small" src="{{item.avatar}}" mode="aspectFill"></image>
              <view class="player-info-small">
                <text class="player-name-small">{{item.name}}</text>
                <text class="player-number-small">{{item.number}}å·</text>
              </view>
              <view class="captain-badge" wx:if="{{item.id === captain1.id}}">é˜Ÿé•¿</view>
            </view>
          </view>
        </view>

        <!-- å¯é€‰çƒå‘˜æ±  -->
        <view class="available-column">
          <view class="available-header">
            <text class="available-title">å¯é€‰çƒå‘˜</text>
            <text class="available-count">å‰©ä½™ {{availablePlayers.length}} äºº</text>
          </view>
          <view class="available-list">
            <view
              class="player-card {{selectedPlayerId === item.id ? 'selected' : ''}}"
              wx:for="{{availablePlayers}}"
              wx:key="id"
              bindtap="onSelectPlayer"
              data-player-id="{{item.id}}">
              <image class="player-avatar" src="{{item.avatar}}" mode="aspectFill"></image>
              <view class="player-info">
                <view class="player-header">
                  <text class="player-name">{{item.name}}</text>
                  <text class="player-number">#{{item.number}}</text>
                </view>
                <position-tag wx:if="{{item.position}}" code="{{item.position}}" size="small"></position-tag>
                <view class="player-stats">
                  <view class="stat-item">
                    <text class="stat-label">âš½</text>
                    <text class="stat-value">{{item.goals}}</text>
                  </view>
                  <view class="stat-item">
                    <text class="stat-label">ğŸ…°ï¸</text>
                    <text class="stat-value">{{item.assists}}</text>
                  </view>
                  <view class="stat-item">
                    <text class="stat-label">ğŸ“Š</text>
                    <text class="stat-value">{{item.rating}}</text>
                  </view>
                  <view class="stat-item">
                    <text class="stat-label">ğŸ“…</text>
                    <text class="stat-value">{{item.attendance * 100}}%</text>
                  </view>
                </view>
              </view>
              <view class="check-icon" wx:if="{{selectedPlayerId === item.id}}">âœ“</view>
            </view>

            <!-- ç©ºçŠ¶æ€ -->
            <view class="empty-state" wx:if="{{availablePlayers.length === 0}}">
              <text class="empty-icon">âœ…</text>
              <text class="empty-text">æ‰€æœ‰çƒå‘˜å·²é€‰å®Œ</text>
            </view>
          </view>
        </view>

        <!-- é˜Ÿä¼2 -->
        <view class="team-column team2-column">
          <view class="team-header">
            <image class="captain-avatar" src="{{captain2.avatar}}" mode="aspectFill"></image>
            <text class="team-title">{{captain2.name}}çš„é˜Ÿä¼</text>
            <text class="team-count">{{team2Players.length}}äºº</text>
          </view>
          <view class="player-list">
            <view class="player-item-small" wx:for="{{team2Players}}" wx:key="id">
              <image class="player-avatar-small" src="{{item.avatar}}" mode="aspectFill"></image>
              <view class="player-info-small">
                <text class="player-name-small">{{item.name}}</text>
                <text class="player-number-small">{{item.number}}å·</text>
              </view>
              <view class="captain-badge" wx:if="{{item.id === captain2.id}}">é˜Ÿé•¿</view>
            </view>
          </view>
        </view>
      </view>

      <!-- ç¡®è®¤é€‰æ‹©æŒ‰é’® -->
      <view class="action-bar" wx:if="{{isMyTurn && selectedPlayerId}}">
        <button class="confirm-btn" bindtap="onConfirmPick">
          ç¡®è®¤é€‰æ‹©
        </button>
      </view>

      <!-- ç­‰å¾…æç¤º -->
      <view class="waiting-tip" wx:if="{{!isMyTurn}}">
        <text class="waiting-icon">â³</text>
        <text class="waiting-text">ç­‰å¾…{{currentTurn === 'captain1' ? captain1.name : captain2.name}}é€‰äºº...</text>
      </view>
    </view>

    <!-- Draftå®Œæˆ - è®¾ç½®é˜Ÿå -->
    <view class="complete-area" wx:if="{{draftStatus === 'completed'}}">
      <view class="complete-header">
        <text class="complete-icon">ğŸ‰</text>
        <text class="complete-title">é€‰äººå®Œæˆï¼</text>
        <text class="complete-subtitle">è¯·ä¸¤ä½é˜Ÿé•¿è®¾ç½®é˜Ÿä¼åç§°</text>
      </view>

      <view class="team-name-section">
        <!-- é˜Ÿä¼1è®¾ç½® -->
        <view class="team-name-card">
          <view class="card-header">
            <text class="card-title">é˜Ÿä¼1</text>
            <text class="card-captain">é˜Ÿé•¿ï¼š{{captain1.name}}</text>
          </view>
          <input
            class="team-name-input"
            placeholder="è¯·è¾“å…¥é˜Ÿä¼åç§°"
            value="{{team1Name}}"
            bindinput="onTeam1NameInput"
            maxlength="20"
          />
          <view class="team-members-preview">
            <text class="preview-label">é˜Ÿå‘˜ï¼ˆ{{team1Players.length}}äººï¼‰ï¼š</text>
            <text class="preview-names">{{team1MemberNames}}</text>
          </view>
        </view>

        <!-- é˜Ÿä¼2è®¾ç½® -->
        <view class="team-name-card">
          <view class="card-header">
            <text class="card-title">é˜Ÿä¼2</text>
            <text class="card-captain">é˜Ÿé•¿ï¼š{{captain2.name}}</text>
          </view>
          <input
            class="team-name-input"
            placeholder="è¯·è¾“å…¥é˜Ÿä¼åç§°"
            value="{{team2Name}}"
            bindinput="onTeam2NameInput"
            maxlength="20"
          />
          <view class="team-members-preview">
            <text class="preview-label">é˜Ÿå‘˜ï¼ˆ{{team2Players.length}}äººï¼‰ï¼š</text>
            <text class="preview-names">{{team2MemberNames}}</text>
          </view>
        </view>
      </view>

      <!-- å‘å¸ƒæŒ‰é’® -->
      <button class="publish-btn" bindtap="onPublishTeams">
        ç¡®è®¤å‘å¸ƒé˜Ÿä¼
      </button>
    </view>

    <!-- åº•éƒ¨å ä½ -->
    <view class="bottom-space"></view>
  </scroll-view>
</view>
