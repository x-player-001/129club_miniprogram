<!-- é˜Ÿä¼åˆ—è¡¨é¡µé¢ -->
<view class="team-list-container">
  <!-- Tabåˆ‡æ¢ - ä½¿ç”¨ tab-bar ç»„ä»¶ -->
  <tab-bar tabs="{{tabs}}" current="{{currentTab}}" bind:change="onTabChange"></tab-bar>

  <!-- å†…å®¹åŒºåŸŸ -->
  <scroll-view class="content" scroll-y enable-back-to-top>
    <!-- å½“å‰é˜Ÿä¼ -->
    <view wx:if="{{currentTab === '0'}}">
      <!-- å½“å‰èµ›å­£ä¿¡æ¯ -->
      <view class="current-season" wx:if="{{currentSeason}}">
        <view class="season-name">{{currentSeason.name}}</view>
        <view class="season-status {{currentSeason.status}}">
          {{currentSeason.status === 'active' ? 'è¿›è¡Œä¸­' : currentSeason.status === 'completed' ? 'å·²å®Œæˆ' : 'å³å°†å¼€å§‹'}}
        </view>
      </view>

      <!-- åˆ›å»ºé˜Ÿä¼å…¥å£ï¼ˆä»…åœ¨æ–°èµ›å­£å¼€å§‹ä¸”æ— é˜Ÿä¼æ—¶æ˜¾ç¤ºï¼‰ -->
      <view class="create-team-prompt" wx:if="{{showCreateUI}}">
        <view class="prompt-icon">ğŸ†</view>
        <view class="prompt-title">æ–°èµ›å­£å·²å¼€å§‹</view>
        <view class="prompt-text">è¯·åˆ›å»ºé˜Ÿä¼å¹¶é€‰æ‹©é˜Ÿå‘˜</view>
        <view class="prompt-actions">
          <button class="prompt-btn create" bindtap="onCreateTeam">
            <text>åˆ›å»ºé˜Ÿä¼</text>
          </button>
          <button class="prompt-btn reshuffle" bindtap="onReshuffle">
            <text>å‘èµ·é‡ç»„</text>
          </button>
        </view>
      </view>

      <!-- å½“å‰é˜Ÿä¼åˆ—è¡¨ - ä½¿ç”¨ team-card ç»„ä»¶ -->
      <view class="team-list" wx:if="{{activeTeams.length > 0}}">
        <team-card
          wx:for="{{activeTeams}}"
          wx:key="id"
          teamData="{{item}}"
          mode="current"
          bind:tap="onTeamCardTap">
        </team-card>
      </view>

      <!-- ç©ºçŠ¶æ€ - ä½¿ç”¨ empty-state ç»„ä»¶ -->
      <view wx:elif="{{!showCreateUI}}">
        <empty-state icon="/static/images/empty-team.png" text="æš‚æ— é˜Ÿä¼" hint="è¯·ç­‰å¾…ç®¡ç†å‘˜åˆ›å»ºé˜Ÿä¼"></empty-state>
      </view>
    </view>

    <!-- å†å²é˜Ÿä¼ -->
    <view wx:if="{{currentTab === '1'}}">
      <!-- èµ›å­£ç­›é€‰å™¨ -->
      <view class="season-filter" bindtap="onShowSeasonPicker">
        <view class="filter-label">èµ›å­£ç­›é€‰</view>
        <view class="filter-value">
          <text class="{{selectedSeasonId ? '' : 'placeholder'}}">{{selectedSeasonName}}</text>
          <image class="dropdown-icon" src="/static/icons/arrow-down.png"></image>
        </view>
      </view>

      <!-- å†å²é˜Ÿä¼åˆ—è¡¨ - ä½¿ç”¨ team-card ç»„ä»¶ -->
      <view class="team-list" wx:if="{{historyTeams.length > 0}}">
        <team-card
          wx:for="{{historyTeams}}"
          wx:key="id"
          teamData="{{item}}"
          mode="history"
          bind:tap="onTeamCardTap">
        </team-card>
      </view>

      <!-- ç©ºçŠ¶æ€ - ä½¿ç”¨ empty-state ç»„ä»¶ -->
      <view wx:else>
        <empty-state icon="/static/images/empty-team.png" text="æš‚æ— å†å²é˜Ÿä¼" hint="{{selectedSeasonId ? 'è¯¥èµ›å­£æš‚æ— å†å²é˜Ÿä¼' : ''}}"></empty-state>
      </view>
    </view>

    <!-- åº•éƒ¨å ä½ -->
    <view class="bottom-space"></view>
  </scroll-view>

  <!-- èµ›å­£é€‰æ‹©å™¨å¼¹çª— -->
  <view class="season-picker-modal" wx:if="{{showSeasonPicker}}" catchtap="onCloseSeasonPicker">
    <view class="picker-content" catchtap="{{null}}">
      <view class="picker-header">
        <text class="picker-title">é€‰æ‹©èµ›å­£</text>
        <view class="close-btn" catchtap="onCloseSeasonPicker">
          <image src="/static/icons/close.png" mode="aspectFit"></image>
        </view>
      </view>

      <scroll-view class="picker-list" scroll-y>
        <!-- èµ›å­£åˆ—è¡¨ -->
        <view
          wx:for="{{allSeasons}}"
          wx:key="id"
          class="season-option {{selectedSeasonId === item.id ? 'active' : ''}}"
          data-id="{{item.id}}"
          data-name="{{item.name}}"
          bindtap="onSelectSeason">
          <view class="option-info">
            <view class="option-name">{{item.name}}</view>
            <view class="option-status {{item.status}}">
              {{item.status === 'active' ? 'è¿›è¡Œä¸­' : item.status === 'completed' ? 'å·²å®Œæˆ' : 'å³å°†å¼€å§‹'}}
            </view>
          </view>
          <image wx:if="{{selectedSeasonId === item.id}}" class="check-icon" src="/static/icons/check.png"></image>
        </view>
      </scroll-view>
    </view>
  </view>
</view>
