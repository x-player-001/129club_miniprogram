# 组件封装分析文档

## 一、组件分析概述

通过分析项目中已完成的15个页面，识别出以下10个高频复用组件，按优先级排序。

## 二、可封装组件清单

### 1. team-card（队伍卡片）⭐⭐⭐⭐⭐
**优先级：极高**
**复用页面：** 4个（首页、队伍列表、队伍对比、Draft页面）

**功能描述：**
- 展示队伍基本信息（logo、名称、队长、颜色）
- 展示队伍战绩（胜/平/负、胜率）
- 支持当前队伍和历史队伍两种展示模式
- 支持点击跳转队伍详情

**属性（Props）：**
```javascript
{
  teamData: {
    id: String,           // 队伍ID
    name: String,         // 队伍名称
    logo: String,         // 队伍Logo URL
    color: String,        // 主题色
    colorDark: String,    // 主题深色
    captainName: String,  // 队长名称
    season: String,       // 赛季
    memberCount: Number,  // 成员数量
    stats: {
      totalMatches: Number,  // 比赛场次
      wins: Number,          // 胜场
      draws: Number,         // 平局
      losses: Number,        // 负场
      winRate: Number        // 胜率
    }
  },
  mode: String,          // 'current' | 'history'
  bindtap: String        // 点击事件
}
```

**使用场景：**
- 首页：我的队伍卡片（简化版）
- 队伍列表：当前队伍列表、历史队伍列表
- 队伍对比：队伍选择器
- Draft页面：显示两支队伍信息

---

### 2. match-card（比赛卡片）⭐⭐⭐⭐⭐
**优先级：极高**
**复用页面：** 4个（首页、比赛列表、队伍详情、个人数据）

**功能描述：**
- 展示比赛对阵信息（两队logo、名称、比分/报名人数）
- 展示比赛时间、地点、状态
- 支持三种状态：未开始、进行中、已结束
- 显示MVP信息（已结束比赛）
- 显示报名按钮（未开始比赛）

**属性（Props）：**
```javascript
{
  matchData: {
    id: String,
    title: String,
    status: String,      // 'upcoming' | 'ongoing' | 'finished'
    team1: {
      id: String,
      name: String,
      logo: String,
      color: String
    },
    team2: { ... },
    team1Score: Number,
    team2Score: Number,
    team1RegisteredCount: Number,
    team2RegisteredCount: Number,
    maxPlayers: Number,
    dateMonth: String,
    dateDay: String,
    time: String,
    location: String,
    currentMinute: Number,  // 进行中时的分钟数
    mvp: {
      name: String,
      avatar: String
    },
    fee: Number,
    registrationDeadline: String,
    isRegistered: Boolean
  },
  mode: String,        // 'full' | 'compact' 完整版/紧凑版
  showActions: Boolean // 是否显示操作按钮
}
```

**事件：**
- `bind:tap` - 点击卡片跳转详情
- `bind:register` - 报名/取消报名

**使用场景：**
- 首页：近期比赛（紧凑版）
- 比赛列表：所有比赛（完整版）
- 队伍详情：队伍比赛记录
- 个人数据：最近参与的比赛

---

### 3. player-card（球员卡片）⭐⭐⭐⭐⭐
**优先级：极高**
**复用页面：** 5个（成员列表、Draft页面、排行榜、队伍详情、个人数据）

**功能描述：**
- 展示球员基本信息（头像、姓名、号码、位置）
- 展示球员队伍信息
- 展示球员数据（进球、助攻、出场）
- 支持选中状态（Draft时）
- 支持队长标识

**属性（Props）：**
```javascript
{
  playerData: {
    id: String,
    avatar: String,
    realName: String,
    nickname: String,
    jerseyNumber: Number,
    position: String,
    teamName: String,
    teamColor: String,
    isCaptain: Boolean,
    totalGoals: Number,
    totalAssists: Number,
    totalMatches: Number,
    mvpCount: Number
  },
  mode: String,        // 'full' | 'compact' | 'draft'
  selected: Boolean,   // Draft模式下是否被选中
  disabled: Boolean    // 是否禁用点击
}
```

**事件：**
- `bind:tap` - 点击球员卡片

**使用场景：**
- 成员列表：完整球员列表
- Draft页面：可选球员列表（带选中状态）
- 排行榜：排名球员展示
- 队伍详情：队员列表
- 个人数据：球员个人信息展示

---

### 4. ranking-item（排名列表项）⭐⭐⭐⭐
**优先级：高**
**复用页面：** 2个（数据总览、排行榜详情）

**功能描述：**
- 展示排名序号（前3名显示奖牌）
- 展示球员基本信息和队伍
- 展示排名指标数据
- 支持高亮当前用户

**属性（Props）：**
```javascript
{
  rankData: {
    id: String,
    rank: Number,
    avatar: String,
    name: String,
    team: String,
    teamColor: String,
    matches: Number,
    value: Number        // 排名指标值
  },
  rankType: String,      // 'goals' | 'assists' | 'mvp' | 'attendance'
  isCurrentUser: Boolean // 是否当前用户
}
```

**使用场景：**
- 数据总览：简化版排行榜（前3名）
- 排行榜详情：完整排行榜

---

### 5. tab-bar（标签栏）⭐⭐⭐⭐
**优先级：高**
**复用页面：** 4个（队伍列表、比赛列表、排行榜、数据总览）

**功能描述：**
- 横向标签切换
- 支持带图标/emoji的标签
- 带下划线动画的激活状态
- 支持横向滚动

**属性（Props）：**
```javascript
{
  tabs: Array[{
    id: String,
    name: String,
    icon: String         // 可选的图标或emoji
  }],
  current: String,       // 当前激活的tab id
}
```

**事件：**
- `bind:change` - 切换tab时触发

**使用场景：**
- 队伍列表：当前队伍/历史队伍
- 比赛列表：未开始/进行中/已结束
- 排行榜：射手榜/助攻榜/MVP榜/出勤榜
- 数据总览：顶部tab切换

---

### 6. empty-state（空状态）⭐⭐⭐⭐
**优先级：高**
**复用页面：** 8个（几乎所有列表页面）

**功能描述：**
- 展示空状态图标
- 展示空状态提示文字
- 展示辅助说明文字
- 支持自定义操作按钮

**属性（Props）：**
```javascript
{
  icon: String,          // 图标URL或emoji
  text: String,          // 主提示文字
  hint: String,          // 辅助说明文字（可选）
  buttonText: String,    // 按钮文字（可选）
}
```

**事件：**
- `bind:action` - 点击按钮时触发

**使用场景：**
- 所有列表页面的空状态展示

---

### 7. stats-grid（数据网格）⭐⭐⭐⭐
**优先级：高**
**复用页面：** 3个（首页、个人数据、数据总览）

**功能描述：**
- 网格布局展示多个数据指标
- 支持带图标的数据卡片
- 支持自定义列数（2列、3列、4列）

**属性（Props）：**
```javascript
{
  stats: Array[{
    icon: String,        // 图标URL
    iconClass: String,   // 图标样式类名
    value: Number | String,
    label: String
  }],
  columns: Number        // 列数：2 | 3 | 4
}
```

**使用场景：**
- 首页：个人数据摘要（4列）
- 个人数据：总体数据（3列）
- 数据总览：快速数据预览

---

### 8. filter-bar（筛选栏）⭐⭐⭐
**优先级：中**
**复用页面：** 3个（成员列表、排行榜、数据总览）

**功能描述：**
- 横向滚动的筛选按钮组
- 支持单选模式
- 支持带颜色标识的选项（队伍筛选）

**属性（Props）：**
```javascript
{
  options: Array[{
    id: String,
    name: String,
    color: String        // 可选的颜色标识
  }],
  current: String,       // 当前选中的选项
}
```

**事件：**
- `bind:change` - 切换选项时触发

**使用场景：**
- 成员列表：按队伍筛选
- 排行榜：全局/队内切换
- 数据总览：各种筛选条件

---

### 9. team-stats-bar（队伍战绩条）⭐⭐⭐
**优先级：中**
**复用页面：** 3个（首页、队伍卡片、队伍详情）

**功能描述：**
- 展示胜/平/负的横向统计
- 颜色编码（胜-绿、平-黄、负-红）
- 支持显示具体数值或仅图标

**属性（Props）：**
```javascript
{
  stats: {
    wins: Number,
    draws: Number,
    losses: Number
  },
  mode: String           // 'full' | 'compact'
}
```

**使用场景：**
- 首页：我的队伍战绩
- 队伍卡片：队伍战绩展示
- 队伍详情：详细战绩

---

### 10. achievement-badge（成就徽章）⭐⭐
**优先级：低**
**复用页面：** 1个（个人数据）

**功能描述：**
- 展示成就图标和名称
- 区分已解锁/未解锁状态
- 已解锁：彩色渐变背景
- 未解锁：灰色半透明

**属性（Props）：**
```javascript
{
  achievementData: {
    id: String,
    name: String,
    icon: String,
    description: String,
    unlocked: Boolean
  }
}
```

**使用场景：**
- 个人数据：成就系统展示

---

## 三、组件优先级总结

### 第一批（极高优先级）- 立即实现
1. **team-card** - 队伍卡片（4个页面复用）
2. **match-card** - 比赛卡片（4个页面复用）
3. **player-card** - 球员卡片（5个页面复用）

### 第二批（高优先级）- 本周完成
4. **ranking-item** - 排名列表项
5. **tab-bar** - 标签栏
6. **empty-state** - 空状态
7. **stats-grid** - 数据网格

### 第三批（中优先级）- 下周完成
8. **filter-bar** - 筛选栏
9. **team-stats-bar** - 队伍战绩条

### 第四批（低优先级）- 按需实现
10. **achievement-badge** - 成就徽章

---

## 四、组件开发规范

### 文件结构
```
components/
├── team-card/
│   ├── team-card.wxml
│   ├── team-card.wxss
│   ├── team-card.js
│   └── team-card.json
├── match-card/
│   └── ...
└── ...
```

### 命名规范
- 组件名：kebab-case（如：team-card）
- 属性名：camelCase（如：teamData）
- 事件名：bind:eventname（如：bind:tap）

### CSS变量继承
所有组件需支持CSS变量系统：
```css
var(--theme-color)        /* 主题色 */
var(--theme-color-dark)   /* 主题深色 */
```

### 数据mock规范
组件内部不包含mock数据，所有数据由页面传入。

---

## 五、代码统计预估

**预计新增代码量：**
- 10个组件 × 平均250行/组件 = 2,500行代码
- WXML: 800行
- WXSS: 1,000行
- JS: 600行
- JSON: 100行

**预计减少代码量：**
- 重构15个页面，平均减少50行/页面 = 750行代码

**净增代码：** 约1,750行
**代码复用率提升：** 预计从当前0%提升至40%

---

## 六、实施计划

### Week 7（本周）
- Day 1-2: 实现第一批组件（team-card, match-card, player-card）
- Day 3-4: 实现第二批组件（ranking-item, tab-bar, empty-state, stats-grid）
- Day 5: 组件测试和文档编写

### Week 8（下周）
- Day 1-3: 重构已有页面使用新组件（15个页面）
- Day 4: 实现第三批组件（filter-bar, team-stats-bar）
- Day 5: 全面测试和优化

### Week 9（视情况）
- 实现第四批组件（achievement-badge）
- 组件库文档完善
- 性能优化

---

## 七、预期收益

1. **代码复用率提升：** 0% → 40%
2. **开发效率提升：** 新页面开发速度提升50%
3. **维护成本降低：** UI调整只需修改组件，自动应用到所有页面
4. **代码可读性提升：** 页面代码简化，结构更清晰
5. **一致性保证：** 所有页面UI风格统一

---

## 八、技术难点

1. **组件灵活性 vs 复杂度：** 需要平衡组件的通用性和简洁性
2. **事件传递：** 组件内部事件需正确传递到页面层
3. **样式隔离：** 确保组件样式不被外部污染
4. **性能优化：** 大量列表场景下的渲染性能

---

生成时间：2025-10-16
文档版本：v1.0
