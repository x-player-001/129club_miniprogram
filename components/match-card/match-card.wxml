<!-- components/match-card/match-card.wxml -->
<view class="match-card {{mode}}" catchtap="onCardTap">
  <!-- å®Œæ•´ç‰ˆå¸ƒå±€ -->
  <block wx:if="{{mode === 'full'}}">
    <!-- æ¯”èµ›å¤´éƒ¨ -->
    <view class="match-header">
      <view class="match-title">{{matchData.title}}</view>
      <view class="match-status status-{{matchData.status}}">
        {{matchData.status === 'upcoming' ? 'æœªå¼€å§‹' : matchData.status === 'ongoing' ? 'è¿›è¡Œä¸­' : 'å·²ç»“æŸ'}}
      </view>
    </view>

    <!-- å¯¹é˜µä¿¡æ¯ -->
    <view class="match-vs">
      <!-- é˜Ÿä¼1 -->
      <view class="team-section">
        <image class="team-logo" src="{{matchData.team1.logo}}" mode="aspectFit"></image>
        <text class="team-name">{{matchData.team1.name}}</text>
        <!-- æœªå¼€å§‹ï¼šæ˜¾ç¤ºæŠ¥åäººæ•° -->
        <view class="team-count" wx:if="{{matchData.status === 'upcoming'}}">
          <text class="count-number">{{matchData.team1RegisteredCount}}</text>
          <text class="count-label">äºº</text>
        </view>
        <!-- è¿›è¡Œä¸­/å·²ç»“æŸï¼šæ˜¾ç¤ºæ¯”åˆ† -->
        <view class="team-score" wx:if="{{matchData.status !== 'upcoming'}}">
          <text class="score-number">{{matchData.team1FinalScore !== undefined ? matchData.team1FinalScore : matchData.team1Score}}</text>
          <text class="goal-number" wx:if="{{matchData.team1TotalGoals !== undefined}}">({{matchData.team1TotalGoals}}çƒ)</text>
        </view>
      </view>

      <!-- VS -->
      <view class="vs-divider">
        <text class="vs-text">VS</text>
      </view>

      <!-- é˜Ÿä¼2 -->
      <view class="team-section">
        <image class="team-logo" src="{{matchData.team2.logo}}" mode="aspectFit"></image>
        <text class="team-name">{{matchData.team2.name}}</text>
        <!-- æœªå¼€å§‹ï¼šæ˜¾ç¤ºæŠ¥åäººæ•° -->
        <view class="team-count" wx:if="{{matchData.status === 'upcoming'}}">
          <text class="count-number">{{matchData.team2RegisteredCount}}</text>
          <text class="count-label">äºº</text>
        </view>
        <!-- è¿›è¡Œä¸­/å·²ç»“æŸï¼šæ˜¾ç¤ºæ¯”åˆ† -->
        <view class="team-score" wx:if="{{matchData.status !== 'upcoming'}}">
          <text class="score-number">{{matchData.team2FinalScore !== undefined ? matchData.team2FinalScore : matchData.team2Score}}</text>
          <text class="goal-number" wx:if="{{matchData.team2TotalGoals !== undefined}}">({{matchData.team2TotalGoals}}çƒ)</text>
        </view>
      </view>
      
    </view>

    <!-- ç‚¹çƒå¤§æˆ˜æ¯”åˆ†ï¼ˆå®Œæ•´ç‰ˆï¼‰ -->
    <view class="penalty-shootout" wx:if="{{matchData.penaltyShootout && matchData.penaltyShootout.enabled}}">
      <view class="penalty-label">ç‚¹çƒå¤§æˆ˜</view>
      <view class="penalty-score">
        <view class="penalty-team {{matchData.penaltyShootout.winner === 'team1' ? 'winner' : ''}}">
          {{matchData.penaltyShootout.team1Score}}
        </view>
        <view class="penalty-separator">-</view>
        <view class="penalty-team {{matchData.penaltyShootout.winner === 'team2' ? 'winner' : ''}}">
          {{matchData.penaltyShootout.team2Score}}
        </view>
      </view>
      <view class="penalty-winner">
        ğŸ† {{matchData.penaltyShootout.winner === 'team1' ? matchData.team1.name : matchData.team2.name}} ç‚¹çƒè·èƒœ
      </view>
    </view>
    
    <!-- æ¯”èµ›ä¿¡æ¯ -->
    <view class="match-info">
      <view class="info-item">
        <image class="info-icon" src="{{icons.match}}" mode="aspectFit"></image>
        <text>{{matchData.dateMonth}}{{matchData.dateDay}}æ—¥ {{matchData.time}}</text>
      </view>
      <view class="info-item">
        <image class="info-icon" src="{{icons.location}}" mode="aspectFit"></image>
        <text>{{matchData.location}}</text>
      </view>
      <view class="info-item">
        <image class="info-icon" src="{{icons.match}}" mode="aspectFit"></image>
        <text>{{matchData.maxPlayersPerTeam || 11}}äººåˆ¶</text>
      </view>
      <view class="info-item" wx:if="{{matchData.status === 'ongoing'}}">
        <text class="live-indicator">â—</text>
        <text class="live-text">ç¬¬{{matchData.currentMinute}}'åˆ†é’Ÿ</text>
      </view>
    </view>


    <!-- MVPæ˜¾ç¤ºï¼ˆå·²ç»“æŸçš„æ¯”èµ›ï¼‰ -->
    <view class="match-mvp" wx:if="{{matchData.status === 'finished' && matchData.mvp}}">
      <image class="mvp-icon" src="{{icons.star}}" mode="aspectFit"></image>
      <text class="mvp-label">MVPï¼š</text>
      <image class="mvp-avatar" src="{{matchData.mvp.avatar}}" mode="aspectFill"></image>
      <text class="mvp-name">{{matchData.mvp.name}}</text>
    </view>

    <!-- æ“ä½œæŒ‰é’®ï¼ˆæœªå¼€å§‹çš„æ¯”èµ›ï¼‰ -->
    <view class="match-actions" wx:if="{{matchData.status === 'upcoming' && showActions}}">
      <button
        class="action-btn {{matchData.isRegistered ? 'cancel-btn' : 'register-btn'}}"
        catchtap="onRegister">
        {{matchData.isRegistered ? 'å–æ¶ˆæŠ¥å' : 'ç«‹å³æŠ¥å'}}
      </button>
    </view>
  </block>

  <!-- ç´§å‡‘ç‰ˆå¸ƒå±€ -->
  <block wx:else>
    <view class="match-date">
      <text class="date-day">{{matchData.dateDay}}</text>
      <text class="date-month">{{matchData.dateMonth}}</text>
    </view>
    <view class="match-info-compact">
      <view class="match-teams">
        <view class="team">
          <image class="team-logo" src="{{matchData.team1.logo}}" mode="aspectFit"></image>
          <text class="team-name">{{matchData.team1.name}}</text>
          <text class="team-score-inline" wx:if="{{matchData.status !== 'upcoming' && matchData.team1FinalScore !== undefined}}">{{matchData.team1FinalScore}}</text>
        </view>
        <view class="match-vs-compact">
          <text class="vs-text">VS</text>
        </view>
        <view class="team">
          <text class="team-score-inline" wx:if="{{matchData.status !== 'upcoming' && matchData.team2FinalScore !== undefined}}">{{matchData.team2FinalScore}}</text>
          <text class="team-name">{{matchData.team2.name}}</text>
          <image class="team-logo" src="{{matchData.team2.logo}}" mode="aspectFit"></image>
        </view>
      </view>
      <view class="match-meta">
        <text class="match-time">{{matchData.time}}</text>
        <text class="match-location">{{matchData.location}}</text>
        <view class="status-tag {{matchData.status}}">
          {{matchData.status === 'upcoming' ? 'æœªå¼€å§‹' : matchData.status === 'ongoing' ? 'è¿›è¡Œä¸­' : 'å·²ç»“æŸ'}}
        </view>
      </view>
      <!-- ç‚¹çƒå¤§æˆ˜æ¯”åˆ†ï¼ˆç´§å‡‘ç‰ˆï¼‰ -->
      <view class="penalty-compact" wx:if="{{matchData.penaltyShootout && matchData.penaltyShootout.enabled}}">
        <view class="penalty-label-compact">ç‚¹çƒå¤§æˆ˜</view>
        <view class="penalty-score-compact">
          <view class="penalty-team-compact {{matchData.penaltyShootout.winner === 'team1' ? 'winner' : ''}}">
            {{matchData.penaltyShootout.team1Score}}
          </view>
          <view class="penalty-separator-compact">-</view>
          <view class="penalty-team-compact {{matchData.penaltyShootout.winner === 'team2' ? 'winner' : ''}}">
            {{matchData.penaltyShootout.team2Score}}
          </view>
        </view>
      </view>
    </view>
  </block>
</view>
